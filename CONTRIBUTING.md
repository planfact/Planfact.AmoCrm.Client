# Внесение вклада в Planfact.AmoCrm.Client

Спасибо за интерес к участию в развитии Planfact.AmoCrm.Client! Это руководство поможет вам начать.

## Начало работы

### Требования

- Git
- .NET 6.0 SDK или новее
- Ваша любимая IDE (Visual Studio, VS Code, Rider и т.д.)

### Настройка среды разработки

1. Сделайте fork репозитория на GitHub
2. Клонируйте ваш fork локально:

   ```bash
   git clone https://github.com/YOUR_USERNAME/Planfact.AmoCrm.Client.git
   cd Planfact.AmoCrm.Client
   ```

3. Восстановите зависимости и соберите проект:

   ```bash
   dotnet restore
   dotnet build
   ```

4. Запустите тесты, чтобы убедиться, что всё работает:

   ```bash
   dotnet test
   ```

## Внесение изменений

### Стратегия ветвления

- Создавайте новую ветку для каждой функции или исправления
- Используйте описательные имена веток:
  - `feature/add-iam-token-support`
  - `fix/validation-timeout-issue`
  - `docs/update-usage-examples`

### Стиль кода

Мы следуем стандартным соглашениям .NET:

- Используйте PascalCase для публичных членов
- Используйте camelCase для приватных полей и локальных переменных
- Добавляйте XML-документацию для публичных API
- Делайте методы сфокусированными и небольшими
- Пишите описательные имена переменных и методов

### Написание тестов

- Все новые функции должны включать тесты
- Стремитесь к высокому покрытию тестами
- Используйте описательные имена тестов, объясняющие сценарий
- Следуйте паттерну Arrange-Act-Assert
- Используйте FluentAssertions для утверждений

Пример:

```csharp
[Fact]
public void AddCachedAmoCrmClient_MissingConfiguration_ThrowsInvalidOperationException()
{
    // Arrange
    IConfigurationRoot emptyConfig = new ConfigurationBuilder().Build();

    // Act & Assert
    FluentActions.Invoking(() => _services.AddCachedAmoCrmClient(emptyConfig))
        .Should().Throw<InvalidOperationException>()
        .WithMessage($"*Section '{nameof(AmoCrmClientOptions)}' not found in configuration.*");
}
```

### Документация

- Обновляйте документацию при изменении API
- Добавляйте примеры для новых функций
- Обновляйте changelog для критических изменений
- Убедитесь, что все публичные API имеют XML-документацию

## Процесс Pull Request

### Перед отправкой

1. Убедитесь, что все тесты проходят:

   ```bash
   dotnet test
   ```

2. Проверьте стиль кода:

   ```bash
   dotnet format --verify-no-changes
   ```

3. Обновите документацию при необходимости
4. Добавьте или обновите тесты для ваших изменений

### Рекомендации для Pull Request

1. **Заголовок**: Используйте ясный, описательный заголовок
   - ✅ "Добавить поддержку IAM Token аутентификации"
   - ❌ "Исправить баги"

2. **Описание**: Включите:
   - Какие изменения были внесены и почему
   - Любые критические изменения
   - Ссылки на связанные issues
   - Скриншоты/примеры, если применимо

3. **Область**: Держите PR сфокусированными на одной функции или исправлении
4. **Тесты**: Включите тесты для новой функциональности
5. **Документация**: Обновите документацию для пользовательских изменений

### Шаблон Pull Request

```markdown
## Описание
Краткое описание изменений.

## Тип изменения

- [ ] Исправление бага (не критическое изменение, которое исправляет проблему)
- [ ] Новая функция (не критическое изменение, которое добавляет функциональность)
- [ ] Критическое изменение (исправление или функция, которая приведет к неработоспособности существующей функциональности)
- [ ] Обновление документации

## Тестирование

- [ ] Я добавил тесты, которые доказывают эффективность моего исправления или работу функции
- [ ] Новые и существующие unit тесты проходят локально с моими изменениями

## Чек-лист

- [ ] Мой код следует руководящим принципам стиля этого проекта
- [ ] Я провел самопроверку своего кода
- [ ] Я прокомментировал код, особенно в сложных для понимания областях
- [ ] Я внес соответствующие изменения в документацию
- [ ] Мои изменения не генерируют новых предупреждений
```

## Принципы разработки

### Принципы дизайна API

1. **Простота прежде всего**: Конфигурация по умолчанию должна работать для 80% случаев использования
2. **Явная конфигурация**: Расширенные опции должны быть четко документированы
3. **Быстрый отказ**: Неверные конфигурации должны выбрасывать исключения рано
4. **Обратная совместимость**: Избегайте критических изменений когда возможно
5. **Согласованные паттерны**: Следуйте существующим соглашениям в кодовой базе

### Соображения производительности

- Минимизируйте выделения памяти в горячих путях
- Используйте `ValueTask` где уместно
- Рассматривайте потокобезопасность для общих ресурсов
- Профилируйте производительность критических путей

### Обработка ошибок

- Используйте специфичные типы исключений для разных сценариев ошибок
- Предоставляйте ясные, практичные сообщения об ошибках
- Включайте контекстную информацию в исключения
- Обрабатывайте граничные случаи изящно

## Типы вкладов

### Отчеты об ошибках

При сообщении об ошибках, пожалуйста, включите:

- Ясное описание проблемы
- Шаги для воспроизведения
- Ожидаемое vs фактическое поведение
- Детали среды (версия .NET, ОС и т.д.)
- Минимальный пример кода, демонстрирующий проблему

### Запросы функций

Для новых функций:

- Объясните случай использования и проблему, которую вы решаете
- Предоставьте примеры того, как функция будет использоваться
- Рассмотрите влияние на обратную совместимость
- Обсудите альтернативные подходы

### Улучшения документации

- Исправьте опечатки и грамматику
- Добавьте недостающие примеры
- Улучшите ясность объяснений
- Обновите устаревшую информацию

### Вклад в код

- Исправления ошибок
- Новые функции
- Улучшения производительности
- Рефакторинг кода

## Процесс релиза

Мы следуем семантическому версионированию (SemVer):

- **Major** (1.0.0): Критические изменения
- **Minor** (0.1.0): Новые функции, обратно совместимые
- **Patch** (0.0.1): Исправления ошибок, обратно совместимые

## Принципы сообщества

### Кодекс поведения

- Будьте уважительными и инклюзивными
- Приветствуйте новичков и помогайте им добиться успеха
- Сосредоточьтесь на конструктивной обратной связи
- Предполагайте добрые намерения

### Получение помощи

- Сначала проверьте существующие issues и документацию
- Задавайте вопросы в GitHub Discussions
- Присоединяйтесь к обсуждениям сообщества
- Предоставляйте контекст при просьбе о помощи

## Правовые вопросы

Внося вклад в Planfact.AmoCrm.Client, вы соглашаетесь, что ваш вклад будет лицензирован под лицензией MIT.

---

Спасибо за помощь в развитии Planfact.AmoCrm.Client!
